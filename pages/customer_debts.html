<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¯ÙŠÙˆÙ† Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ | SmartKey Pro</title>

<style>
    body { direction: rtl; font-family: sans-serif; padding: 15px; }
    table { width: 100%; border-collapse: collapse; margin-top: 15px; }
    th, td { padding: 12px; border-bottom: 1px solid #ddd; text-align: center; }
    th { background: #000; color: #fff; }
</style>

<script type="module">
import { supabase } from "../js/supabase.js";

const loadDebts = async () => {
    const { data } = await supabase
        .from("sales_invoices")
        .select("*, customers(name, phone)")
        .gte("remaining_amount", 1);

    let tbody = document.getElementById("rows");
    tbody.innerHTML = "";

    data.forEach(inv => {
        tbody.innerHTML += `
            <tr>
                <td>${inv.customers?.name || "-"}</td>
                <td>${inv.customers?.phone || "-"}</td>
                <td>${inv.total_amount}</td>
                <td>${inv.paid_amount}</td>
                <td style="color:red;font-weight:bold">${inv.remaining_amount}</td>
            </tr>
        `;
    });
};

window.onload = loadDebts;
</script>

</head>

<body>
<h2>ğŸ’° Ø¯ÙŠÙˆÙ† Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h2>

<table>
    <thead>
        <tr>
            <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
            <th>Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„</th>
            <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</th>
            <th>Ø§Ù„Ù…Ø¯ÙÙˆØ¹</th>
            <th>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</th>
        </tr>
    </thead>
    <tbody id="rows"></tbody>
</table>

</body>
</html>
