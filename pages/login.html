<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>

<style>
    body {
        background:#000;
        color:#fff;
        font-family:Tajawal, sans-serif;
        text-align:center;
        padding:30px;
    }
    h2 { color:gold; margin-bottom:20px; }
    input {
        width:90%;
        padding:12px;
        margin:10px auto;
        border-radius:10px;
        border:1px solid gold;
        background:#111;
        color:#fff;
        font-size:18px;
        display:block;
    }
    button {
        background:gold;
        color:#000;
        padding:12px;
        width:90%;
        border:none;
        border-radius:10px;
        font-size:20px;
        font-weight:bold;
        margin-top:10px;
        cursor:pointer;
    }
</style>
</head>

<body>

<h2>ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>

<input id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
<input id="pin" type="password" placeholder="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø³Ø±ÙŠ">

<button onclick="login()">Ø¯Ø®ÙˆÙ„</button>

<script type="module">
import { supabase } from "../supabase.js";

window.login = async function () {
    const username = document.getElementById("username").value.trim();
    const pin = document.getElementById("pin").value.trim();

    if (!username || !pin) {
        alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø©");
        return;
    }

    const { data, error } = await supabase
        .from("users")
        .select("*")
        .eq("username", username)
        .eq("pin", pin)
        .single();

    if (error || !data) {
        alert("âŒ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©");
        return;
    }

    // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    localStorage.setItem("role", data.role);
    localStorage.setItem("username", data.username);

    if (data.role === "manager") {
        window.location.href = "../index.html"; // ØµÙØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±
    } else if (data.role === "seller") {
        window.location.href = "seller_dashboard.html"; // ØµÙØ­Ø© Ø§Ù„Ø¨Ø§Ø¦Ø¹
    }
};
</script>

</body>
</html>
